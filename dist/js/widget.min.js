!function(t,e,n,i){"use strict";function o(e,n){this.element=e,this.page=t(e).find(".page"),this.options=t.extend({},l,n),this._defaults=l,this._name=s,this.isLoading=!0,this.draggable=null,this.tween=null,this.calculateProgress=null,this.init()}var s="autoScroll",l={by:"continuous",speed:"medium",pause:5,click:!1,minimumMovement:3};o.prototype={init:function(){function e(){s.tween.pause(),TweenLite.killDelayedCallsTo(s.calculateProgress),TweenLite.killDelayedCallsTo(l),TweenLite.killDelayedCallsTo(a)}var n,o,s=this,l=null,a=null,r=t(this.element).outerHeight(!0),c=r,u=this.element.scrollHeight-this.element.offsetHeight;this.calculateProgress=function(){c=t(s.element).scrollTop()+r,s.tween.progress(t(s.element).scrollTop()/u).play()},this.canScroll()?("page"===this.options.by?(n="fastest"===this.options.speed?.4:"fast"===this.options.speed?.8:"medium"===this.options.speed?1.2:"slow"===this.options.speed?1.6:2,o=this.page.outerHeight(!0)/t(this.element).outerHeight(!0)*n):(n="fastest"===this.options.speed?60:"fast"===this.options.speed?50:"medium"===this.options.speed?40:"slow"===this.options.speed?30:20,o=Math.abs((this.page.outerHeight(!0)-t(this.element).outerHeight(!0))/n)),Draggable.create(this.element,{type:"scrollTop",throwProps:!0,edgeResistance:.75,minimumMovement:s.options.minimumMovement,onPress:function(){e()},onRelease:function(){"none"!==s.options.by&&TweenLite.delayedCall(s.options.pause,s.calculateProgress)},onClick:function(){s.options.click&&(e(),t(s.element).trigger("scrollClick",[this.pointerEvent]))}}),this.draggable=Draggable.get(this.element),this.tween=TweenLite.to(this.draggable.scrollProxy,o,{scrollTop:u,ease:Linear.easeNone,delay:this.options.pause,paused:!0,onUpdate:"page"===this.options.by?function(){Math.abs(s.draggable.scrollProxy.top())>=c&&(s.tween.pause(),c+=r,TweenLite.delayedCall(s.options.pause,a=function(){s.tween.resume()}))}:i,onComplete:function(){TweenLite.delayedCall(s.options.pause,l=function(){TweenLite.to(s.page,1,{autoAlpha:0,onComplete:function(){s.tween.seek(0).pause(),"page"===s.options.by&&(c=r),t(s.element).trigger("done")}})})}}),TweenLite.set(this.element,{overflowY:"hidden"})):this.options.click&&(Draggable.create(this.element,{type:"scrollTop",throwProps:!0,edgeResistance:.95,minimumMovement:this.options.minimumMovement,onClick:function(){t(s.element).trigger("scrollClick",[this.pointerEvent])}}),this.draggable=Draggable.get(this.element))},canScroll:function(){return this.options&&this.page.height()>t(this.element).height()},destroy:function(){t(this.element).removeData(),this.tween&&this.tween.kill(),this.draggable&&this.draggable.kill(),this.element=null,this.page=null,this.options=null,this._defaults=null,this.draggable=null,this.tween=null,this.calculateProgress=null}},o.prototype.play=function(){this.canScroll()&&"none"!==this.options.by&&this.tween&&(this.isLoading?(this.tween.play(),this.isLoading=!1):(TweenLite.to(this.page,1,{autoAlpha:1}),TweenLite.delayedCall(this.options.pause,this.calculateProgress)))},o.prototype.pause=function(){this.tween&&(TweenLite.killDelayedCallsTo(this.calculateProgress),this.tween.pause())},o.prototype.stop=function(){this.tween&&(TweenLite.killDelayedCallsTo(this.calculateProgress),this.tween.kill()),this.element=null,this.page=null},t.fn.autoScroll=function(e){return this.each(function(){t.data(this,"plugin_"+s)||t.data(this,"plugin_"+s,new o(this,e))})}}(jQuery,window,document);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Utilities=function(){function t(t,e){var n="font-family:"+e.font.family+"; ",i="color: "+(e.color?e.color:e.forecolor)+"; ",o="font-size: "+(-1===e.size.indexOf("px")?e.size+"px; ":e.size+"; "),s="font-weight: "+(e.bold?"bold":"normal")+"; ",l="font-style: "+(e.italic?"italic":"normal")+"; ",a="text-decoration: "+(e.underline?"underline":"none")+"; ",r="background-color: "+(e.highlightColor?e.highlightColor:e.backcolor)+"; ";return"."+t+" {"+n+i+o+s+l+a+r+"}"}function e(t){for(var e=document.createElement("style"),n=0,i=t.length;i>n;n++)e.appendChild(document.createTextNode(t[n]));document.head.appendChild(e)}function n(n,s){n.forEach(function(n){n.class&&n.fontSetting&&e([t(n.class,n.fontSetting)]),n.fontSetting.font.type&&("custom"===n.fontSetting.font.type&&n.fontSetting.font.family&&n.fontSetting.font.url?i(n.fontSetting.font.family,n.fontSetting.font.url,s):"google"===n.fontSetting.font.type&&n.fontSetting.font.family&&o(n.fontSetting.font.family,s))})}function i(t,e,n){var i=null,o="font-family: "+t+"; src: url('"+e+"');";n=n||document,i=n.styleSheets[0],null!==i&&i.addRule("@font-face",o)}function o(t,e){var n=document.createElement("link");e=e||document,n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href","https://fonts.googleapis.com/css?family="+t.split(",")[0]),null!==n&&e.getElementsByTagName("head")[0].appendChild(n)}function s(t){for(var e=t.length,n=[],i=0;e>i;i++)n[i]=new Image,n[i].src=t[i]}function l(t){for(var e,n=window.location.search.substring(1),i=n.split("&"),o=0;o<i.length;o++)if(e=i[o].split("="),e[0]==t)return decodeURIComponent(e[1]);return""}return{getQueryParameter:l,getFontCssStyle:t,addCSSRules:e,loadFonts:n,loadCustomFont:i,loadGoogleFont:o,preloadImages:s}}();var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-13"]),_gaq.push(["_trackPageview"]),function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}();var RiseVision=RiseVision||{};RiseVision.Text={},RiseVision.Text=function(t){"use strict";function e(){var t=0,e=[],n=[];document.querySelector(".page").innerHTML=u.data,$.each($("<div/>").html(u.data).find("span").addBack(),function(){for(n=i(this),t=0;t<n.length;t++)e.push(n[t])}),g.addCSSRules(e),$("#container").autoScroll(u.scroll).on("done",function(){s()}),o()}function n(t){return".wysiwyg-font-family-"+t.replace(/ /g,"-").toLowerCase()+" { font-family: '"+t+"'; }"}function i(t){var e=[],i=$(t).attr("data-google-font"),o=$(t).attr("data-custom-font");return i&&(g.loadGoogleFont(i),e.push(n(i))),o&&(g.loadCustomFont(o,$(t).attr("data-custom-font-url")),e.push(n(o))),e}function o(){t.rpc.call("","rsevent_ready",null,p.getString("id"),!0,!0,!0,!0,!0)}function s(){t.rpc.call("","rsevent_done",null,p.getString("id"))}function l(t){u=JSON.parse(JSON.stringify(t)),u.width=p.getInt("rsW"),u.height=p.getInt("rsH"),document.getElementById("container").style.width=u.width+"px",document.getElementById("container").style.height=u.height+"px",e()}function a(){$("#container").data("plugin_autoScroll")&&$("#container").data("plugin_autoScroll").play()}function r(){$("#container").data("plugin_autoScroll")&&$("#container").data("plugin_autoScroll").pause()}function c(){r()}var u=null,p=new t.Prefs,g=RiseVision.Common.Utilities;return{pause:r,play:a,setAdditionalParams:l,stop:c}}(gadgets),function(t,e){"use strict";function n(t,e){var n,i="",o="";Array.isArray(t)&&t.length>0&&Array.isArray(e)&&e.length>0&&("companyId"===t[0]&&(i=e[0]),"displayId"===t[1]&&(o=e[1]?e[1]:"preview"),"additionalParams"===t[2]&&(n=JSON.parse(e[2]),RiseVision.Text.setAdditionalParams(n)))}function i(){RiseVision.Text.play()}function o(){RiseVision.Text.pause()}function s(){RiseVision.Text.stop()}var l=new e.Prefs,a=l.getString("id");t.oncontextmenu=function(){return!1},document.body.onmousedown=function(){return!1},a&&""!==a&&(e.rpc.register("rscmd_play_"+a,i),e.rpc.register("rscmd_pause_"+a,o),e.rpc.register("rscmd_stop_"+a,s),e.rpc.register("rsparam_set_"+a,n),e.rpc.call("","rsparam_get",null,a,["companyId","displayId","additionalParams"]))}(window,gadgets);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiUGx1Z2luIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJ0aGlzIiwicGFnZSIsImZpbmQiLCJleHRlbmQiLCJkZWZhdWx0cyIsIl9kZWZhdWx0cyIsIl9uYW1lIiwicGx1Z2luTmFtZSIsImlzTG9hZGluZyIsImRyYWdnYWJsZSIsInR3ZWVuIiwiY2FsY3VsYXRlUHJvZ3Jlc3MiLCJpbml0IiwiYnkiLCJzcGVlZCIsInBhdXNlIiwiY2xpY2siLCJtaW5pbXVtTW92ZW1lbnQiLCJwcm90b3R5cGUiLCJwYXVzZVR3ZWVuIiwic2VsZiIsIlR3ZWVuTGl0ZSIsImtpbGxEZWxheWVkQ2FsbHNUbyIsInNjcm9sbENvbXBsZXRlIiwicGFnZUNvbXBsZXRlIiwiZHVyYXRpb24iLCJlbGVtZW50SGVpZ2h0Iiwib3V0ZXJIZWlnaHQiLCJwYXVzZUhlaWdodCIsIm1heCIsInNjcm9sbEhlaWdodCIsIm9mZnNldEhlaWdodCIsInNjcm9sbFRvcCIsInByb2dyZXNzIiwicGxheSIsImNhblNjcm9sbCIsIk1hdGgiLCJhYnMiLCJEcmFnZ2FibGUiLCJjcmVhdGUiLCJ0eXBlIiwidGhyb3dQcm9wcyIsImVkZ2VSZXNpc3RhbmNlIiwib25QcmVzcyIsIm9uUmVsZWFzZSIsImRlbGF5ZWRDYWxsIiwib25DbGljayIsInRyaWdnZXIiLCJwb2ludGVyRXZlbnQiLCJnZXQiLCJ0byIsInNjcm9sbFByb3h5IiwiZWFzZSIsIkxpbmVhciIsImVhc2VOb25lIiwiZGVsYXkiLCJwYXVzZWQiLCJvblVwZGF0ZSIsInRvcCIsInJlc3VtZSIsIm9uQ29tcGxldGUiLCJhdXRvQWxwaGEiLCJzZWVrIiwic2V0Iiwib3ZlcmZsb3dZIiwiaGVpZ2h0IiwiZGVzdHJveSIsInJlbW92ZURhdGEiLCJraWxsIiwic3RvcCIsImZuIiwiYXV0b1Njcm9sbCIsImVhY2giLCJkYXRhIiwialF1ZXJ5IiwiUmlzZVZpc2lvbiIsIkNvbW1vbiIsIlV0aWxpdGllcyIsImdldEZvbnRDc3NTdHlsZSIsImNsYXNzTmFtZSIsImZvbnRPYmoiLCJmYW1pbHkiLCJmb250IiwiY29sb3IiLCJmb3JlY29sb3IiLCJzaXplIiwiaW5kZXhPZiIsIndlaWdodCIsImJvbGQiLCJpdGFsaWMiLCJ1bmRlcmxpbmUiLCJoaWdobGlnaHQiLCJoaWdobGlnaHRDb2xvciIsImJhY2tjb2xvciIsImFkZENTU1J1bGVzIiwicnVsZXMiLCJzdHlsZSIsImNyZWF0ZUVsZW1lbnQiLCJpIiwibGVuZ3RoIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsImhlYWQiLCJsb2FkRm9udHMiLCJzZXR0aW5ncyIsImNvbnRlbnREb2MiLCJmb3JFYWNoIiwiaXRlbSIsImNsYXNzIiwiZm9udFNldHRpbmciLCJ1cmwiLCJsb2FkQ3VzdG9tRm9udCIsImxvYWRHb29nbGVGb250Iiwic2hlZXQiLCJydWxlIiwic3R5bGVTaGVldHMiLCJhZGRSdWxlIiwic3R5bGVzaGVldCIsInNldEF0dHJpYnV0ZSIsInNwbGl0IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwcmVsb2FkSW1hZ2VzIiwidXJscyIsImltYWdlcyIsIkltYWdlIiwic3JjIiwiZ2V0UXVlcnlQYXJhbWV0ZXIiLCJwYXJhbSIsInBhaXIiLCJxdWVyeSIsImxvY2F0aW9uIiwic2VhcmNoIiwic3Vic3RyaW5nIiwidmFycyIsImRlY29kZVVSSUNvbXBvbmVudCIsIl9nYXEiLCJwdXNoIiwiZ2EiLCJhc3luYyIsInByb3RvY29sIiwicyIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiLCJUZXh0IiwiZ2FkZ2V0cyIsIl9pbml0IiwiZm9udFJ1bGVzIiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsIl9hZGRpdGlvbmFsUGFyYW1zIiwiaHRtbCIsImFkZEJhY2siLCJfZ2V0Rm9udFJ1bGVzIiwiX3V0aWxzIiwic2Nyb2xsIiwib24iLCJfZG9uZSIsIl9yZWFkeSIsIl9jcmVhdGVGb250UnVsZSIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsImVsZW0iLCJnb29nbGVGb250IiwiYXR0ciIsImN1c3RvbUZvbnQiLCJycGMiLCJjYWxsIiwiX3ByZWZzIiwiZ2V0U3RyaW5nIiwic2V0QWRkaXRpb25hbFBhcmFtcyIsImFkZGl0aW9uYWxQYXJhbXMiLCJKU09OIiwicGFyc2UiLCJzdHJpbmdpZnkiLCJ3aWR0aCIsImdldEludCIsImdldEVsZW1lbnRCeUlkIiwiUHJlZnMiLCJjb25maWd1cmUiLCJuYW1lcyIsInZhbHVlcyIsImNvbXBhbnlJZCIsImRpc3BsYXlJZCIsIkFycmF5IiwiaXNBcnJheSIsInByZWZzIiwiaWQiLCJvbmNvbnRleHRtZW51IiwiYm9keSIsIm9ubW91c2Vkb3duIiwicmVnaXN0ZXIiXSwibWFwcGluZ3MiOiJDQU9DLFNBQVdBLEVBQUdDLEVBQVFDLEVBQVVDLEdBQ2hDLFlBWUEsU0FBU0MsR0FBT0MsRUFBU0MsR0FDeEJDLEtBQUtGLFFBQVVBLEVBQ2ZFLEtBQUtDLEtBQU9SLEVBQUVLLEdBQVNJLEtBQUssU0FDNUJGLEtBQUtELFFBQVVOLEVBQUVVLFVBQVdDLEVBQVVMLEdBQ3RDQyxLQUFLSyxVQUFZRCxFQUNqQkosS0FBS00sTUFBUUMsRUFDYlAsS0FBS1EsV0FBWSxFQUNqQlIsS0FBS1MsVUFBWSxLQUNqQlQsS0FBS1UsTUFBUSxLQUNiVixLQUFLVyxrQkFBb0IsS0FDekJYLEtBQUtZLE9BcEJOLEdBQUlMLEdBQWEsYUFDaEJILEdBQ0NTLEdBQUksYUFDSkMsTUFBTyxTQUNQQyxNQUFPLEVBQ1BDLE9BQU8sRUFDUEMsZ0JBQWlCLEVBaUJuQnBCLEdBQU9xQixXQUNOTixLQUFNLFdBU0wsUUFBU08sS0FDUkMsRUFBS1YsTUFBTUssUUFFWE0sVUFBVUMsbUJBQW1CRixFQUFLVCxtQkFDbENVLFVBQVVDLG1CQUFtQkMsR0FFN0JGLFVBQVVDLG1CQUFtQkUsR0FkOUIsR0FBSVYsR0FBT1csRUFDUEwsRUFBT3BCLEtBQ1B1QixFQUFpQixLQUNqQkMsRUFBZSxL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dkJwRyxLQUFRQSxJQUVUMkUsU0FJSCxTQUFXdEosRUFBUXNKLEdBQ2pCLFlBYUEsU0FBU2tDLEdBQVVDLEVBQU9DLEdBQ3hCLEdBQUlWLEdBQ0ZXLEVBQVksR0FDWkMsRUFBWSxFQUVWQyxPQUFNQyxRQUFRTCxJQUFVQSxFQUFNaEYsT0FBUyxHQUFLb0YsTUFBTUMsUUFBUUosSUFBV0EsRUFBT2pGLE9BQVMsSUFDdEUsY0FBYmdGLEVBQU0sS0FDUkUsRUFBWUQsRUFBTyxJQUdKLGNBQWJELEVBQU0sS0FFTkcsRUFERUYsRUFBTyxHQUNHQSxFQUFPLEdBR1AsV0FJQyxxQkFBYkQsRUFBTSxLQUNSVCxFQUFtQkMsS0FBS0MsTUFBTVEsRUFBTyxJQUVyQ3pHLFdBQVdvRSxLQUFLMEIsb0JBQW9CQyxLQWMxQyxRQUFTeEksS0FDUHlDLFdBQVdvRSxLQUFLN0csT0FHbEIsUUFBU25CLEtBQ1A0RCxXQUFXb0UsS0FBS2hJLFFBR2xCLFFBQVNzRCxLQUNQTSxXQUFXb0UsS0FBSzFFLE9BeERsQixHQUFJb0gsR0FBUSxHQUFJekMsR0FBUWlDLE1BQ3RCUyxFQUFLRCxFQUFNakIsVUFBVSxLQUV2QjlLLEdBQU9pTSxjQUFnQixXQUNyQixPQUFPLEdBR1RoTSxTQUFTaU0sS0FBS0MsWUFBYyxXQUMxQixPQUFPLEdBOEJMSCxHQUFhLEtBQVBBLElBQ1IxQyxFQUFRcUIsSUFBSXlCLFNBQVMsY0FBZ0JKLEVBQUl4SixHQUN6QzhHLEVBQVFxQixJQUFJeUIsU0FBUyxlQUFpQkosRUFBSTNLLEdBQzFDaUksRUFBUXFCLElBQUl5QixTQUFTLGNBQWdCSixFQUFJckgsR0FFekMyRSxFQUFRcUIsSUFBSXlCLFNBQVMsZUFBaUJKLEVBQUlSLEdBQzFDbEMsRUFBUXFCLElBQUlDLEtBQUssR0FBSSxjQUFlLEtBQU1vQixHQUFLLFlBQWEsWUFBYSx1QkFjMUVoTSxPQUFRc0oiLCJmaWxlIjoianMvd2lkZ2V0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiAgUHJvamVjdDogQXV0by1TY3JvbGxcbiAqICBEZXNjcmlwdGlvbjogQXV0by1zY3JvbGwgcGx1Z2luIGZvciB1c2Ugd2l0aCBSaXNlIFZpc2lvbiBXaWRnZXRzXG4gKiAgQXV0aG9yOiBAZG9ubmFwZXBcbiAqICBMaWNlbnNlOiBNSVRcbiAqL1xuXG47KGZ1bmN0aW9uICgkLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0dmFyIHBsdWdpbk5hbWUgPSBcImF1dG9TY3JvbGxcIixcblx0XHRkZWZhdWx0cyA9IHtcblx0XHRcdGJ5OiBcImNvbnRpbnVvdXNcIixcblx0XHRcdHNwZWVkOiBcIm1lZGl1bVwiLFxuXHRcdFx0cGF1c2U6IDUsXG5cdFx0XHRjbGljazogZmFsc2UsXG5cdFx0XHRtaW5pbXVtTW92ZW1lbnQ6IDMgLy8gRHJhZ2dhYmxlIGRlZmF1bHQgdmFsdWUgLSBodHRwOi8vZ3JlZW5zb2NrLmNvbS9kb2NzLyMvSFRNTDUvRHJhZy9EcmFnZ2FibGUvXG5cdFx0fTtcblxuXG5cdGZ1bmN0aW9uIFBsdWdpbihlbGVtZW50LCBvcHRpb25zKSB7XG5cdFx0dGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblx0XHR0aGlzLnBhZ2UgPSAkKGVsZW1lbnQpLmZpbmQoXCIucGFnZVwiKTtcblx0XHR0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgZGVmYXVsdHMsIG9wdGlvbnMpO1xuXHRcdHRoaXMuX2RlZmF1bHRzID0gZGVmYXVsdHM7XG5cdFx0dGhpcy5fbmFtZSA9IHBsdWdpbk5hbWU7XG5cdFx0dGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuXHRcdHRoaXMuZHJhZ2dhYmxlID0gbnVsbDtcblx0XHR0aGlzLnR3ZWVuID0gbnVsbDtcblx0XHR0aGlzLmNhbGN1bGF0ZVByb2dyZXNzID0gbnVsbDtcblx0XHR0aGlzLmluaXQoKTtcblx0fVxuXG5cdFBsdWdpbi5wcm90b3R5cGUgPSB7XG5cdFx0aW5pdDogZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIHNwZWVkLCBkdXJhdGlvbjtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHZhciBzY3JvbGxDb21wbGV0ZSA9IG51bGw7XG5cdFx0XHR2YXIgcGFnZUNvbXBsZXRlID0gbnVsbDtcblx0XHRcdHZhciBlbGVtZW50SGVpZ2h0ID0gJCh0aGlzLmVsZW1lbnQpLm91dGVySGVpZ2h0KHRydWUpO1xuXHRcdFx0dmFyIHBhdXNlSGVpZ2h0ID0gZWxlbWVudEhlaWdodDtcblx0XHRcdHZhciBtYXggPSB0aGlzLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0IC0gdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodDtcblxuXHRcdFx0ZnVuY3Rpb24gcGF1c2VUd2VlbigpIHtcblx0XHRcdFx0c2VsZi50d2Vlbi5wYXVzZSgpO1xuXG5cdFx0XHRcdFR3ZWVuTGl0ZS5raWxsRGVsYXllZENhbGxzVG8oc2VsZi5jYWxjdWxhdGVQcm9ncmVzcyk7XG5cdFx0XHRcdFR3ZWVuTGl0ZS5raWxsRGVsYXllZENhbGxzVG8oc2Nyb2xsQ29tcGxldGUpO1xuXHRcdFx0XHQvLyBPbmx5IHVzZWQgd2hlbiBzY3JvbGxpbmcgYnkgcGFnZS5cblx0XHRcdFx0VHdlZW5MaXRlLmtpbGxEZWxheWVkQ2FsbHNUbyhwYWdlQ29tcGxldGUpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmNhbGN1bGF0ZVByb2dyZXNzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIFNldCBwYXVzZUhlaWdodCB0byBuZXcgdmFsdWUuXG5cdFx0XHRcdHBhdXNlSGVpZ2h0ID0gJChzZWxmLmVsZW1lbnQpLnNjcm9sbFRvcCgpICtcblx0XHRcdFx0XHRlbGVtZW50SGVpZ2h0O1xuXG5cdFx0XHRcdHNlbGYudHdlZW4ucHJvZ3Jlc3MoJChzZWxmLmVsZW1lbnQpLnNjcm9sbFRvcCgpIC8gbWF4KVxuXHRcdFx0XHRcdC5wbGF5KCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRpZiAodGhpcy5jYW5TY3JvbGwoKSkge1xuXHRcdFx0XHQvLyBTZXQgc2Nyb2xsIHNwZWVkLlxuXHRcdFx0XHRpZiAodGhpcy5vcHRpb25zLmJ5ID09PSBcInBhZ2VcIikge1xuXHRcdFx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc3BlZWQgPT09IFwiZmFzdGVzdFwiKSB7XG5cdFx0XHRcdFx0XHRzcGVlZCA9IDAuNDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSBpZiAodGhpcy5vcHRpb25zLnNwZWVkID09PSBcImZhc3RcIikge1xuXHRcdFx0XHRcdFx0c3BlZWQgPSAwLjg7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zcGVlZCA9PT0gXCJtZWRpdW1cIikge1xuXHRcdFx0XHRcdFx0c3BlZWQgPSAxLjI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zcGVlZCA9PT0gXCJzbG93XCIpIHtcblx0XHRcdFx0XHRcdHNwZWVkID0gMS42O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdHNwZWVkID0gMjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRkdXJhdGlvbiA9IHRoaXMucGFnZS5vdXRlckhlaWdodCh0cnVlKSAvXG5cdFx0XHRcdFx0XHQkKHRoaXMuZWxlbWVudCkub3V0ZXJIZWlnaHQodHJ1ZSkgKiBzcGVlZDtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIHsgIC8vIENvbnRpbnVvdXMgb3IgYnkgcm93XG5cdFx0XHRcdFx0aWYgKHRoaXMub3B0aW9ucy5zcGVlZCA9PT0gXCJmYXN0ZXN0XCIpIHtcblx0XHRcdFx0XHRcdHNwZWVkID0gNjA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zcGVlZCA9PT0gXCJmYXN0XCIpIHtcblx0XHRcdFx0XHRcdHNwZWVkID0gNTA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zcGVlZCA9PT0gXCJtZWRpdW1cIikge1xuXHRcdFx0XHRcdFx0c3BlZWQgPSA0MDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSBpZiAodGhpcy5vcHRpb25zLnNwZWVkID09PSBcInNsb3dcIikge1xuXHRcdFx0XHRcdFx0c3BlZWQgPSAzMDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRzcGVlZCA9IDIwO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGR1cmF0aW9uID0gTWF0aC5hYnMoKHRoaXMucGFnZS5vdXRlckhlaWdodCh0cnVlKSAtXG5cdFx0XHRcdFx0XHQkKHRoaXMuZWxlbWVudCkub3V0ZXJIZWlnaHQodHJ1ZSkpIC8gc3BlZWQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0RHJhZ2dhYmxlLmNyZWF0ZSh0aGlzLmVsZW1lbnQsIHtcblx0XHRcdFx0XHR0eXBlOiBcInNjcm9sbFRvcFwiLFxuXHRcdFx0XHRcdHRocm93UHJvcHM6IHRydWUsXG5cdFx0XHRcdFx0ZWRnZVJlc2lzdGFuY2U6IDAuNzUsXG5cdFx0XHRcdFx0bWluaW11bU1vdmVtZW50OiBzZWxmLm9wdGlvbnMubWluaW11bU1vdmVtZW50LFxuXHRcdFx0XHRcdG9uUHJlc3M6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cGF1c2VUd2VlbigpO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0b25SZWxlYXNlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGlmIChzZWxmLm9wdGlvbnMuYnkgIT09IFwibm9uZVwiKSB7XG5cdFx0XHRcdFx0XHRcdC8qIEZpZ3VyZSBvdXQgd2hhdCB0aGUgbmV3IHNjcm9sbCBwb3NpdGlvbiBpcyBhbmRcblx0XHRcdFx0XHRcdFx0IHRyYW5zbGF0ZSB0aGF0IGludG8gdGhlIHByb2dyZXNzIG9mIHRoZSB0d2VlbiAoMC0xKVxuXHRcdFx0XHRcdFx0XHQgc28gdGhhdCB3ZSBjYW4gY2FsaWJyYXRlIGl0OyBvdGhlcndpc2UsIGl0J2QganVtcFxuXHRcdFx0XHRcdFx0XHQgYmFjayB0byB3aGVyZSBpdCBwYXVzZWQgd2hlbiB3ZSByZXN1bWUoKS4gKi9cblx0XHRcdFx0XHRcdFx0VHdlZW5MaXRlLmRlbGF5ZWRDYWxsKHNlbGYub3B0aW9ucy5wYXVzZSwgc2VsZi5jYWxjdWxhdGVQcm9ncmVzcyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRvbkNsaWNrOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGlmIChzZWxmLm9wdGlvbnMuY2xpY2spIHtcblx0XHRcdFx0XHRcdFx0cGF1c2VUd2VlbigpO1xuXHRcdFx0XHRcdFx0XHQkKHNlbGYuZWxlbWVudCkudHJpZ2dlcihcInNjcm9sbENsaWNrXCIsIFt0aGlzLnBvaW50ZXJFdmVudF0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dGhpcy5kcmFnZ2FibGUgPSBEcmFnZ2FibGUuZ2V0KHRoaXMuZWxlbWVudCk7XG5cblx0XHRcdFx0dGhpcy50d2VlbiA9IFR3ZWVuTGl0ZS50byh0aGlzLmRyYWdnYWJsZS5zY3JvbGxQcm94eSwgZHVyYXRpb24sIHtcblx0XHRcdFx0XHRzY3JvbGxUb3A6IG1heCxcblx0XHRcdFx0XHRlYXNlOiBMaW5lYXIuZWFzZU5vbmUsXG5cdFx0XHRcdFx0ZGVsYXk6IHRoaXMub3B0aW9ucy5wYXVzZSxcblx0XHRcdFx0XHRwYXVzZWQ6IHRydWUsXG5cdFx0XHRcdFx0b25VcGRhdGU6ICh0aGlzLm9wdGlvbnMuYnkgPT09IFwicGFnZVwiID8gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpZiAoTWF0aC5hYnMoc2VsZi5kcmFnZ2FibGUuc2Nyb2xsUHJveHkudG9wKCkpID49IHBhdXNlSGVpZ2h0KSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYudHdlZW4ucGF1c2UoKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBOZXh0IGhlaWdodCBhdCB3aGljaCB0byBwYXVzZSBzY3JvbGxpbmcuXG5cdFx0XHRcdFx0XHRcdHBhdXNlSGVpZ2h0ICs9IGVsZW1lbnRIZWlnaHQ7XG5cblx0XHRcdFx0XHRcdFx0VHdlZW5MaXRlLmRlbGF5ZWRDYWxsKHNlbGYub3B0aW9ucy5wYXVzZSxcblx0XHRcdFx0XHRcdFx0XHRwYWdlQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYudHdlZW4ucmVzdW1lKCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gOiB1bmRlZmluZWQpLFxuXHRcdFx0XHRcdG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0VHdlZW5MaXRlLmRlbGF5ZWRDYWxsKHNlbGYub3B0aW9ucy5wYXVzZSxcblx0XHRcdFx0XHRcdFx0c2Nyb2xsQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRUd2VlbkxpdGUudG8oc2VsZi5wYWdlLCAxLCB7XG5cdFx0XHRcdFx0XHRcdFx0XHRhdXRvQWxwaGE6IDAsXG5cdFx0XHRcdFx0XHRcdFx0XHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2VsZi50d2Vlbi5zZWVrKDApLnBhdXNlKCk7XG5cblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHNlbGYub3B0aW9ucy5ieSA9PT0gXCJwYWdlXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRwYXVzZUhlaWdodCA9IGVsZW1lbnRIZWlnaHQ7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKHNlbGYuZWxlbWVudCkudHJpZ2dlcihcImRvbmVcIik7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBIaWRlIHNjcm9sbGJhci5cblx0XHRcdFx0VHdlZW5MaXRlLnNldCh0aGlzLmVsZW1lbnQsIHsgb3ZlcmZsb3dZOiBcImhpZGRlblwiIH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKHRoaXMub3B0aW9ucy5jbGljaykge1xuXHRcdFx0XHRcdC8vIEFjY291bnQgZm9yIGNvbnRlbnQgdGhhdCBpcyB0byBiZSBjbGlja2VkIHdoZW4gY29udGVudCBub3QgbmVlZGVkIHRvIGJlIHNjcm9sbGVkXG5cdFx0XHRcdFx0Ly8gTGV2ZXJhZ2UgRHJhZ2dhYmxlIGZvciB0b3VjaC9jbGljayBldmVudCBoYW5kbGluZ1xuXHRcdFx0XHRcdERyYWdnYWJsZS5jcmVhdGUodGhpcy5lbGVtZW50LCB7XG5cdFx0XHRcdFx0XHR0eXBlOiBcInNjcm9sbFRvcFwiLFxuXHRcdFx0XHRcdFx0dGhyb3dQcm9wczogdHJ1ZSxcblx0XHRcdFx0XHRcdGVkZ2VSZXNpc3RhbmNlOiAwLjk1LFxuXHRcdFx0XHRcdFx0bWluaW11bU1vdmVtZW50OiB0aGlzLm9wdGlvbnMubWluaW11bU1vdmVtZW50LFxuXHRcdFx0XHRcdFx0b25DbGljazogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdCQoc2VsZi5lbGVtZW50KS50cmlnZ2VyKFwic2Nyb2xsQ2xpY2tcIiwgW3RoaXMucG9pbnRlckV2ZW50XSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHR0aGlzLmRyYWdnYWJsZSA9IERyYWdnYWJsZS5nZXQodGhpcy5lbGVtZW50KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Ly8gQ2hlY2sgaWYgY29udGVudCBpcyBsYXJnZXIgdGhhbiB2aWV3YWJsZSBhcmVhIGFuZCBpZiB0aGUgc2Nyb2xsIHNldHRpbmdzIGlzIHNldCB0byBhY3R1YWxseSBzY3JvbGwuXG5cdFx0Y2FuU2Nyb2xsOiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLm9wdGlvbnMgJiYgKHRoaXMucGFnZS5oZWlnaHQoKSA+ICQodGhpcy5lbGVtZW50KS5oZWlnaHQoKSk7XG5cdFx0fSxcblx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdCQodGhpcy5lbGVtZW50KS5yZW1vdmVEYXRhKCk7XG5cdFx0XHRpZiAodGhpcy50d2Vlbikge1xuXHRcdFx0XHR0aGlzLnR3ZWVuLmtpbGwoKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMuZHJhZ2dhYmxlKSB7XG5cdFx0XHRcdHRoaXMuZHJhZ2dhYmxlLmtpbGwoKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmVtb3ZlIGVsZW1lbnRzLlxuXHRcdFx0dGhpcy5lbGVtZW50ID0gbnVsbDtcblx0XHRcdHRoaXMucGFnZSA9IG51bGw7XG5cdFx0XHR0aGlzLm9wdGlvbnMgPSBudWxsO1xuXHRcdFx0dGhpcy5fZGVmYXVsdHMgPSBudWxsO1xuXHRcdFx0dGhpcy5kcmFnZ2FibGUgPSBudWxsO1xuXHRcdFx0dGhpcy50d2VlbiA9IG51bGw7XG5cdFx0XHR0aGlzLmNhbGN1bGF0ZVByb2dyZXNzID0gbnVsbDtcblx0XHR9XG5cdH07XG5cblx0UGx1Z2luLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuY2FuU2Nyb2xsKCkgJiYgdGhpcy5vcHRpb25zLmJ5ICE9PSBcIm5vbmVcIikge1xuXHRcdFx0aWYgKHRoaXMudHdlZW4pIHtcblx0XHRcdFx0aWYgKHRoaXMuaXNMb2FkaW5nKSB7XG5cdFx0XHRcdFx0dGhpcy50d2Vlbi5wbGF5KCk7XG5cdFx0XHRcdFx0dGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRUd2VlbkxpdGUudG8odGhpcy5wYWdlLCAxLCB7YXV0b0FscGhhOiAxfSk7XG5cdFx0XHRcdFx0VHdlZW5MaXRlLmRlbGF5ZWRDYWxsKHRoaXMub3B0aW9ucy5wYXVzZSwgdGhpcy5jYWxjdWxhdGVQcm9ncmVzcyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0UGx1Z2luLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLnR3ZWVuKSB7XG5cdFx0XHRUd2VlbkxpdGUua2lsbERlbGF5ZWRDYWxsc1RvKHRoaXMuY2FsY3VsYXRlUHJvZ3Jlc3MpO1xuXHRcdFx0dGhpcy50d2Vlbi5wYXVzZSgpO1xuXHRcdH1cblx0fTtcblxuXHRQbHVnaW4ucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy50d2Vlbikge1xuXHRcdFx0VHdlZW5MaXRlLmtpbGxEZWxheWVkQ2FsbHNUbyh0aGlzLmNhbGN1bGF0ZVByb2dyZXNzKTtcblx0XHRcdHRoaXMudHdlZW4ua2lsbCgpO1xuXHRcdH1cblxuXHRcdHRoaXMuZWxlbWVudCA9IG51bGw7XG5cdFx0dGhpcy5wYWdlID0gbnVsbDtcblx0fTtcblxuXHQvLyBBIGxpZ2h0d2VpZ2h0IHBsdWdpbiB3cmFwcGVyIGFyb3VuZCB0aGUgY29uc3RydWN0b3IgdGhhdCBwcmV2ZW50c1xuXHQvLyBtdWx0aXBsZSBpbnN0YW50aWF0aW9ucy5cblx0JC5mbi5hdXRvU2Nyb2xsID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoISQuZGF0YSh0aGlzLCBcInBsdWdpbl9cIiArIHBsdWdpbk5hbWUpKSB7XG5cdFx0XHRcdCQuZGF0YSh0aGlzLCBcInBsdWdpbl9cIiArIHBsdWdpbk5hbWUsIG5ldyBQbHVnaW4odGhpcywgb3B0aW9ucykpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9O1xufSkoalF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbiA9IFJpc2VWaXNpb24uQ29tbW9uIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5VdGlsaXRpZXMgPSAoZnVuY3Rpb24oKSB7XG5cbiAgZnVuY3Rpb24gZ2V0Rm9udENzc1N0eWxlKGNsYXNzTmFtZSwgZm9udE9iaikge1xuICAgIHZhciBmYW1pbHkgPSBcImZvbnQtZmFtaWx5OlwiICsgZm9udE9iai5mb250LmZhbWlseSArIFwiOyBcIjtcbiAgICB2YXIgY29sb3IgPSBcImNvbG9yOiBcIiArIChmb250T2JqLmNvbG9yID8gZm9udE9iai5jb2xvciA6IGZvbnRPYmouZm9yZWNvbG9yKSArIFwiOyBcIjtcbiAgICB2YXIgc2l6ZSA9IFwiZm9udC1zaXplOiBcIiArIChmb250T2JqLnNpemUuaW5kZXhPZihcInB4XCIpID09PSAtMSA/IGZvbnRPYmouc2l6ZSArIFwicHg7IFwiIDogZm9udE9iai5zaXplICsgXCI7IFwiKTtcbiAgICB2YXIgd2VpZ2h0ID0gXCJmb250LXdlaWdodDogXCIgKyAoZm9udE9iai5ib2xkID8gXCJib2xkXCIgOiBcIm5vcm1hbFwiKSArIFwiOyBcIjtcbiAgICB2YXIgaXRhbGljID0gXCJmb250LXN0eWxlOiBcIiArIChmb250T2JqLml0YWxpYyA/IFwiaXRhbGljXCIgOiBcIm5vcm1hbFwiKSArIFwiOyBcIjtcbiAgICB2YXIgdW5kZXJsaW5lID0gXCJ0ZXh0LWRlY29yYXRpb246IFwiICsgKGZvbnRPYmoudW5kZXJsaW5lID8gXCJ1bmRlcmxpbmVcIiA6IFwibm9uZVwiKSArIFwiOyBcIjtcbiAgICB2YXIgaGlnaGxpZ2h0ID0gXCJiYWNrZ3JvdW5kLWNvbG9yOiBcIiArIChmb250T2JqLmhpZ2hsaWdodENvbG9yID8gZm9udE9iai5oaWdobGlnaHRDb2xvciA6IGZvbnRPYmouYmFja2NvbG9yKSArIFwiOyBcIjtcblxuICAgIHJldHVybiBcIi5cIiArIGNsYXNzTmFtZSArIFwiIHtcIiArIGZhbWlseSArIGNvbG9yICsgc2l6ZSArIHdlaWdodCArIGl0YWxpYyArIHVuZGVybGluZSArIGhpZ2hsaWdodCArIFwifVwiO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkQ1NTUnVsZXMocnVsZXMpIHtcbiAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gcnVsZXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHN0eWxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHJ1bGVzW2ldKSk7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gIH1cblxuICAvKlxuICAgKiBMb2FkcyBHb29nbGUgb3IgY3VzdG9tIGZvbnRzLCBpZiBhcHBsaWNhYmxlLCBhbmQgaW5qZWN0cyBDU1Mgc3R5bGVzXG4gICAqIGludG8gdGhlIGhlYWQgb2YgdGhlIGRvY3VtZW50LlxuICAgKlxuICAgKiBAcGFyYW0gICAgYXJyYXkgICAgc2V0dGluZ3MgICAgQXJyYXkgb2Ygb2JqZWN0cyB3aXRoIHRoZSBmb2xsb3dpbmcgZm9ybTpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbe1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGFzc1wiOiBcImRhdGVcIixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZm9udFNldHRpbmdcIjoge1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbGQ6IHRydWUsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiYmxhY2tcIixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiB7XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYW1pbHk6IFwiQWtyb25pbVwiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udDogXCJBa3JvbmltXCIsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlZlcmRhbmFcIixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZ29vZ2xlXCIsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiaHR0cDovL2N1c3RvbS1mb250LXVybFwiXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0YWxpYzogZmFsc2UsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogXCIyMFwiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVybGluZTogZmFsc2VcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgKlxuICAgKiAgICAgICAgICAgb2JqZWN0ICAgY29udGVudERvYyAgICBEb2N1bWVudCBvYmplY3QgaW50byB3aGljaCB0byBpbmplY3Qgc3R5bGVzXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBsb2FkIGZvbnRzIChvcHRpb25hbCkuXG4gICAqL1xuICBmdW5jdGlvbiBsb2FkRm9udHMoc2V0dGluZ3MsIGNvbnRlbnREb2MpIHtcbiAgICBzZXR0aW5ncy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtLmNsYXNzICYmIGl0ZW0uZm9udFNldHRpbmcpIHtcbiAgICAgICAgYWRkQ1NTUnVsZXMoWyBnZXRGb250Q3NzU3R5bGUoaXRlbS5jbGFzcywgaXRlbS5mb250U2V0dGluZykgXSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpdGVtLmZvbnRTZXR0aW5nLmZvbnQudHlwZSkge1xuICAgICAgICBpZiAoaXRlbS5mb250U2V0dGluZy5mb250LnR5cGUgPT09IFwiY3VzdG9tXCIgJiYgaXRlbS5mb250U2V0dGluZy5mb250LmZhbWlseSAmJlxuICAgICAgICAgIGl0ZW0uZm9udFNldHRpbmcuZm9udC51cmwpIHtcbiAgICAgICAgICBsb2FkQ3VzdG9tRm9udChpdGVtLmZvbnRTZXR0aW5nLmZvbnQuZmFtaWx5LCBpdGVtLmZvbnRTZXR0aW5nLmZvbnQudXJsLFxuICAgICAgICAgICAgY29udGVudERvYyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXRlbS5mb250U2V0dGluZy5mb250LnR5cGUgPT09IFwiZ29vZ2xlXCIgJiYgaXRlbS5mb250U2V0dGluZy5mb250LmZhbWlseSkge1xuICAgICAgICAgIGxvYWRHb29nbGVGb250KGl0ZW0uZm9udFNldHRpbmcuZm9udC5mYW1pbHksIGNvbnRlbnREb2MpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBsb2FkQ3VzdG9tRm9udChmYW1pbHksIHVybCwgY29udGVudERvYykge1xuICAgIHZhciBzaGVldCA9IG51bGw7XG4gICAgdmFyIHJ1bGUgPSBcImZvbnQtZmFtaWx5OiBcIiArIGZhbWlseSArIFwiOyBcIiArIFwic3JjOiB1cmwoJ1wiICsgdXJsICsgXCInKTtcIjtcblxuICAgIGNvbnRlbnREb2MgPSBjb250ZW50RG9jIHx8IGRvY3VtZW50O1xuXG4gICAgc2hlZXQgPSBjb250ZW50RG9jLnN0eWxlU2hlZXRzWzBdO1xuXG4gICAgaWYgKHNoZWV0ICE9PSBudWxsKSB7XG4gICAgICBzaGVldC5hZGRSdWxlKFwiQGZvbnQtZmFjZVwiLCBydWxlKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBsb2FkR29vZ2xlRm9udChmYW1pbHksIGNvbnRlbnREb2MpIHtcbiAgICB2YXIgc3R5bGVzaGVldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xuXG4gICAgY29udGVudERvYyA9IGNvbnRlbnREb2MgfHwgZG9jdW1lbnQ7XG5cbiAgICBzdHlsZXNoZWV0LnNldEF0dHJpYnV0ZShcInJlbFwiLCBcInN0eWxlc2hlZXRcIik7XG4gICAgc3R5bGVzaGVldC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dC9jc3NcIik7XG5cbiAgICAvLyBzcGxpdCB0byBhY2NvdW50IGZvciBmYW1pbHkgdmFsdWUgY29udGFpbmluZyBhIGZhbGxiYWNrIChlZy4gQWxhZGluLHNhbnMtc2VyaWYpXG4gICAgc3R5bGVzaGVldC5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsIFwiaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3M/ZmFtaWx5PVwiICsgZmFtaWx5LnNwbGl0KFwiLFwiKVswXSk7XG5cbiAgICBpZiAoc3R5bGVzaGVldCAhPT0gbnVsbCkge1xuICAgICAgY29udGVudERvYy5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0uYXBwZW5kQ2hpbGQoc3R5bGVzaGVldCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcHJlbG9hZEltYWdlcyh1cmxzKSB7XG4gICAgdmFyIGxlbmd0aCA9IHVybHMubGVuZ3RoLFxuICAgICAgaW1hZ2VzID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpbWFnZXNbaV0gPSBuZXcgSW1hZ2UoKTtcbiAgICAgIGltYWdlc1tpXS5zcmMgPSB1cmxzW2ldO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFF1ZXJ5UGFyYW1ldGVyKHBhcmFtKSB7XG4gICAgdmFyIHF1ZXJ5ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSksXG4gICAgICB2YXJzID0gcXVlcnkuc3BsaXQoXCImXCIpLFxuICAgICAgcGFpcjtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFycy5sZW5ndGg7IGkrKykge1xuICAgICAgcGFpciA9IHZhcnNbaV0uc3BsaXQoXCI9XCIpO1xuXG4gICAgICBpZiAocGFpclswXSA9PSBwYXJhbSkge1xuICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBcIlwiO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBnZXRRdWVyeVBhcmFtZXRlcjogZ2V0UXVlcnlQYXJhbWV0ZXIsXG4gICAgZ2V0Rm9udENzc1N0eWxlOiAgZ2V0Rm9udENzc1N0eWxlLFxuICAgIGFkZENTU1J1bGVzOiAgICAgIGFkZENTU1J1bGVzLFxuICAgIGxvYWRGb250czogICAgICAgIGxvYWRGb250cyxcbiAgICBsb2FkQ3VzdG9tRm9udDogICBsb2FkQ3VzdG9tRm9udCxcbiAgICBsb2FkR29vZ2xlRm9udDogICBsb2FkR29vZ2xlRm9udCxcbiAgICBwcmVsb2FkSW1hZ2VzOiAgICBwcmVsb2FkSW1hZ2VzXG4gIH07XG59KSgpO1xuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbXCJfc2V0QWNjb3VudFwiLCBcIlVBLTU3MDkyMTU5LTEzXCJdKTtcbl9nYXEucHVzaChbXCJfdHJhY2tQYWdldmlld1wiXSk7XG5cbihmdW5jdGlvbigpIHtcbiAgdmFyIGdhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTsgZ2EudHlwZSA9IFwidGV4dC9qYXZhc2NyaXB0XCI7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKFwiaHR0cHM6XCIgPT0gZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgPyBcImh0dHBzOi8vc3NsXCIgOiBcImh0dHA6Ly93d3dcIikgKyBcIi5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qc1wiO1xuICB2YXIgcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuXG4vKiBnbG9iYWwgZ2FkZ2V0czpmYWxzZSAqL1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlRleHQgPSB7fTtcblxuUmlzZVZpc2lvbi5UZXh0ID0gKGZ1bmN0aW9uKGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9hZGRpdGlvbmFsUGFyYW1zID0gbnVsbCxcbiAgICBfcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpLFxuICAgIF91dGlscyA9IFJpc2VWaXNpb24uQ29tbW9uLlV0aWxpdGllcztcblxuICAvKlxuICAgKiAgUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBfaW5pdCgpIHtcbiAgICB2YXIgaSA9IDAsXG4gICAgICBydWxlcyA9IFtdLFxuICAgICAgZm9udFJ1bGVzID0gW107XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBhZ2VcIikuaW5uZXJIVE1MID0gX2FkZGl0aW9uYWxQYXJhbXMuZGF0YTtcblxuICAgIC8vIEl0ZXJhdGUgb3ZlciB0aGUgZGF0YSB0byBmaW5kIGFueSBjdXN0b20gb3IgR29vZ2xlIGZvbnRzIHRoYXQgYXJlIGJlaW5nIHVzZWQuXG4gICAgJC5lYWNoKCQoXCI8ZGl2Lz5cIikuaHRtbChfYWRkaXRpb25hbFBhcmFtcy5kYXRhKS5maW5kKFwic3BhblwiKS5hZGRCYWNrKCksIGZ1bmN0aW9uKCkge1xuICAgICAgZm9udFJ1bGVzID0gX2dldEZvbnRSdWxlcyh0aGlzKTtcblxuICAgICAgZm9yIChpID0gMDsgaSA8IGZvbnRSdWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBydWxlcy5wdXNoKGZvbnRSdWxlc1tpXSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBfdXRpbHMuYWRkQ1NTUnVsZXMocnVsZXMpO1xuXG4gICAgJChcIiNjb250YWluZXJcIikuYXV0b1Njcm9sbChfYWRkaXRpb25hbFBhcmFtcy5zY3JvbGwpLm9uKFwiZG9uZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgIF9kb25lKCk7XG4gICAgfSk7XG5cbiAgICBfcmVhZHkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9jcmVhdGVGb250UnVsZShmb250KSB7XG4gICAgcmV0dXJuIFwiLnd5c2l3eWctZm9udC1mYW1pbHktXCIgKyBmb250LnJlcGxhY2UoLyAvZywgXCItXCIpLnRvTG93ZXJDYXNlKCkgKyBcIiB7IGZvbnQtZmFtaWx5OiAnXCIgKyBmb250ICsgXCInOyB9XCI7XG4gIH1cblxuICAvLyBDcmVhdGUgQ1NTIHJ1bGVzIGZvciBmb250cy5cbiAgZnVuY3Rpb24gX2dldEZvbnRSdWxlcyhlbGVtKSB7XG4gICAgdmFyIHJ1bGVzID0gW10sXG4gICAgICBnb29nbGVGb250ID0gJChlbGVtKS5hdHRyKFwiZGF0YS1nb29nbGUtZm9udFwiKSxcbiAgICAgIGN1c3RvbUZvbnQgPSAkKGVsZW0pLmF0dHIoXCJkYXRhLWN1c3RvbS1mb250XCIpO1xuXG4gICAgLy8gTG9hZCBHb29nbGUgZm9udC5cbiAgICBpZiAoZ29vZ2xlRm9udCkge1xuICAgICAgX3V0aWxzLmxvYWRHb29nbGVGb250KGdvb2dsZUZvbnQpO1xuXG4gICAgICAvLyBBZGQgQ1NTIGZvciB0aGUgR29vZ2xlIGZvbnQuXG4gICAgICBydWxlcy5wdXNoKF9jcmVhdGVGb250UnVsZShnb29nbGVGb250KSk7XG4gICAgfVxuXG4gICAgLy8gTG9hZCBjdXN0b20gZm9udC5cbiAgICBpZiAoY3VzdG9tRm9udCkge1xuICAgICAgX3V0aWxzLmxvYWRDdXN0b21Gb250KGN1c3RvbUZvbnQsICQoZWxlbSkuYXR0cihcImRhdGEtY3VzdG9tLWZvbnQtdXJsXCIpKTtcblxuICAgICAgLy8gQWRkIENTUyBmb3IgdGhlIGN1c3RvbSBmb250LlxuICAgICAgcnVsZXMucHVzaChfY3JlYXRlRm9udFJ1bGUoY3VzdG9tRm9udCkpO1xuICAgIH1cblxuICAgIHJldHVybiBydWxlcztcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9yZWFkeVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksIHRydWUsXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9kb25lKCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X2RvbmVcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gc2V0QWRkaXRpb25hbFBhcmFtcyhhZGRpdGlvbmFsUGFyYW1zKSB7XG4gICAgX2FkZGl0aW9uYWxQYXJhbXMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFkZGl0aW9uYWxQYXJhbXMpKTtcblxuICAgIF9hZGRpdGlvbmFsUGFyYW1zLndpZHRoID0gX3ByZWZzLmdldEludChcInJzV1wiKTtcbiAgICBfYWRkaXRpb25hbFBhcmFtcy5oZWlnaHQgPSBfcHJlZnMuZ2V0SW50KFwicnNIXCIpO1xuXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250YWluZXJcIikuc3R5bGUud2lkdGggPSBfYWRkaXRpb25hbFBhcmFtcy53aWR0aCArIFwicHhcIjtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbnRhaW5lclwiKS5zdHlsZS5oZWlnaHQgPSBfYWRkaXRpb25hbFBhcmFtcy5oZWlnaHQgKyBcInB4XCI7XG5cbiAgICBfaW5pdCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBpZiAoJChcIiNjb250YWluZXJcIikuZGF0YShcInBsdWdpbl9hdXRvU2Nyb2xsXCIpKSB7XG4gICAgICAkKFwiI2NvbnRhaW5lclwiKS5kYXRhKFwicGx1Z2luX2F1dG9TY3JvbGxcIikucGxheSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIGlmICgkKFwiI2NvbnRhaW5lclwiKS5kYXRhKFwicGx1Z2luX2F1dG9TY3JvbGxcIikpIHtcbiAgICAgICQoXCIjY29udGFpbmVyXCIpLmRhdGEoXCJwbHVnaW5fYXV0b1Njcm9sbFwiKS5wYXVzZSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgcGF1c2UoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJwYXVzZVwiOiBwYXVzZSxcbiAgICBcInBsYXlcIjogcGxheSxcbiAgICBcInNldEFkZGl0aW9uYWxQYXJhbXNcIjogc2V0QWRkaXRpb25hbFBhcmFtcyxcbiAgICBcInN0b3BcIjogc3RvcFxuICB9O1xufSkoZ2FkZ2V0cyk7XG5cbi8qIGdsb2JhbCBSaXNlVmlzaW9uLCBnYWRnZXRzICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgZG9jdW1lbnQuYm9keS5vbm1vdXNlZG93biA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBmdW5jdGlvbiBjb25maWd1cmUobmFtZXMsIHZhbHVlcykge1xuICAgIHZhciBhZGRpdGlvbmFsUGFyYW1zLFxuICAgICAgY29tcGFueUlkID0gXCJcIixcbiAgICAgIGRpc3BsYXlJZCA9IFwiXCI7XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lcykgJiYgbmFtZXMubGVuZ3RoID4gMCAmJiBBcnJheS5pc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmIChuYW1lc1swXSA9PT0gXCJjb21wYW55SWRcIikge1xuICAgICAgICBjb21wYW55SWQgPSB2YWx1ZXNbMF07XG4gICAgICB9XG5cbiAgICAgIGlmIChuYW1lc1sxXSA9PT0gXCJkaXNwbGF5SWRcIikge1xuICAgICAgICBpZiAodmFsdWVzWzFdKSB7XG4gICAgICAgICAgZGlzcGxheUlkID0gdmFsdWVzWzFdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGRpc3BsYXlJZCA9IFwicHJldmlld1wiO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChuYW1lc1syXSA9PT0gXCJhZGRpdGlvbmFsUGFyYW1zXCIpIHtcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtcyA9IEpTT04ucGFyc2UodmFsdWVzWzJdKTtcblxuICAgICAgICBSaXNlVmlzaW9uLlRleHQuc2V0QWRkaXRpb25hbFBhcmFtcyhhZGRpdGlvbmFsUGFyYW1zKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoaWQgJiYgaWQgIT09IFwiXCIpIHtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BsYXlfXCIgKyBpZCwgcGxheSk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wYXVzZV9cIiArIGlkLCBwYXVzZSk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3ApO1xuXG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBjb25maWd1cmUpO1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc3BhcmFtX2dldFwiLCBudWxsLCBpZCwgW1wiY29tcGFueUlkXCIsIFwiZGlzcGxheUlkXCIsIFwiYWRkaXRpb25hbFBhcmFtc1wiXSk7XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIFJpc2VWaXNpb24uVGV4dC5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlRleHQucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgUmlzZVZpc2lvbi5UZXh0LnN0b3AoKTtcbiAgfVxufSkod2luZG93LCBnYWRnZXRzKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
